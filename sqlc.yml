---
version: '2'
plugins:
  - name: bulkinsert
    process:
      cmd: sqlc-plugin-bulk-go
overrides:
  go:
    overrides:
      - column: categories.category_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: 'CategoryID'
      - column: articles.article_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleID
      - column: article_revisions.article_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleID
      - column: article_revisions.article_revision_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleRevisionID
      - column: article_revisions.authored_at
        go_type:
          import: 'github.com/aereal/nikki/backend/infra/db/dto'
          type: 'DateTime'
      - column: article_publications.article_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleID
      - column: article_publications.article_revision_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleRevisionID
      - column: article_publications.published_at
        go_type:
          import: 'github.com/aereal/nikki/backend/infra/db/dto'
          type: 'DateTime'
      - column: article_category_mappings.article_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: ArticleID
      - column: article_category_mappings.category_id
        go_type:
          import: 'github.com/aereal/nikki/backend/domain'
          type: 'CategoryID'
sql:
  - engine: sqlite
    schema: './backend/infra/db/schema.sql'
    queries: './backend/infra/db/queries.sql'
    codegen:
      - plugin: bulkinsert
        out: ./backend/infra/db/queries
        options:
          package: queries
    gen:
      go:
        out: './backend/infra/db/queries'
        output_db_file_name: 'db_gen.go'
        output_models_file_name: 'models_gen.go'
        output_files_suffix: _gen
        emit_result_struct_pointers: true
  - engine: sqlite
    schema: './backend/infra/db/schema.sql'
    queries: './backend/infra/db/test/queries.sql'
    codegen:
      - plugin: bulkinsert
        out: ./backend/infra/db/test/queries
        options:
          package: queries
    gen:
      go:
        out: './backend/infra/db/test/queries'
        output_db_file_name: 'db_gen.go'
        output_models_file_name: 'models_gen.go'
        output_files_suffix: _gen
        emit_result_struct_pointers: true
